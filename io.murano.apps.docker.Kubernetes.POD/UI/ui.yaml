Version: 2

Templates:
  service:
     ?:
       type: io.murano.apps.docker.Kubernetes.Service
     name: $.appConfiguration.name + '-service'
     kubernetes: $.appConfiguration.kubernetes
     port:  $.service_config.port
     containerPort: $.service_config.containerPort
     externalLB: $.service_config.externalLB
     enabled: $.service_config.enable_service
     selector:
       name: $.appConfiguration.name
Application:
  ?:
    type: io.murano.apps.docker.Kubernetes.POD
  name: $.appConfiguration.name
  labels:
    name: $.appConfiguration.name
  kubernetes: $.appConfiguration.kubernetes
  replication: $.appConfiguration.replicate
  replicationFactor: $.appConfiguration.replication_factor
  service: $service
  exposePort: $.appConfiguration.expose


Forms:
  - appConfiguration:
      fields:
        - name: name
          type: string
          label: Application Name
          required: true
          description: >-
            This name will be used as an id and name label for the Pod
        - name: labels
          type: string
          label: Labels
          required: false
          description: >-
            Comma separated list of labels in JSON form {'key':'value',}
        - name: kubernetes
          type: io.murano.apps.docker.Kubernetes
          label: Kubernetes containers cluster
          required: true
          description: >-
            Kubernetes containers cluster is required for a Pod deployement.
        - name: expose
          type: boolean
          label: Expose port on a host
          initial: false
          description: >-
            By default a Pod container's ports are not exposed to the host. In order to allow external access
              to the container ports this option should be enabled.
          required: false
          widgetMedia:
             css: {all: ['muranodashboard/css/checkbox.css']}
        - name: replicate
          type: boolean
          label: Replicate
          initial: false
          required: false
          description: >-
            If enabled, a new ReplicationController will be created instead of a single Pod.
          widgetMedia:
             css: {all: ['muranodashboard/css/checkbox.css']}
        - name: replication_factor
          type: integer
          label: Replicas
          initial: 2
          description: >-
            Defines a number of POD clones that will be created by Kubernetes replication controller.
          required: false
  - service_config:
      fields:
        - name: enable_service
          type: boolean
          label: Enable Kubernetes service for the Pod
          required: false
          description: >-
            Kubernetes Pods can be announced as a service for Kubernetes applications. If this option is enabled a
            new Kubernetes service entity will be created. Kubernetes will allocate a service IP address and this service
            will be accessible from any Pod via this IP address.
        - name: port
          type: integer
          label: Service Port
          required: false
          description: >-
            TCP\UDP Port which should be announced by a service.
        - name: containerPort
          type: integer
          label: Container Port
          required: false
          description: >-
            Pod's container port which should be bound to a service.
        - name: externalLB
          type: boolean
          label: Enable External LB
          initial: false
          required: false
          description:
            Enable external LoadBalancing for a service. A new LoadBalancing pool will be created by OpenStack Neutron.
          widgetMedia:
             css: {all: ['muranodashboard/css/checkbox.css']}